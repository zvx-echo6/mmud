{% extends "admin/base.html" %}

{% block title %}System Status{% endblock %}

{% block admin_content %}
  <div class="page-header" style="padding-top:20px;">
    <h1 class="page-title" style="font-size:22px;">System</h1>
  </div>

  {# ═══ DATABASE ═══ #}
  <div class="divider">DATABASE</div>

  <table class="admin-table">
    <tbody>
      <tr>
        <td style="color:var(--text-ghost);">Path</td>
        <td>{{ db_path }}</td>
      </tr>
      <tr>
        <td style="color:var(--text-ghost);">Size</td>
        <td>{% if db_size is not none %}{{ (db_size / 1024)|round(1) }} KB{% else %}<span style="color:var(--blood-bright);">not found</span>{% endif %}</td>
      </tr>
    </tbody>
  </table>

  {# ═══ NODE STATUS ═══ #}
  <div class="divider">SIM NODES</div>

  <table class="admin-table">
    <thead>
      <tr>
        <th>Role</th>
        <th>Node ID</th>
        <th>Assigned</th>
      </tr>
    </thead>
    <tbody>
      {% for node in nodes %}
      <tr>
        <td style="color:var(--parchment);">{{ node.role }}</td>
        <td>{{ node.mesh_node_id or '—' }}</td>
        <td>{{ node.assigned_at or '—' }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {# ═══ ADMIN LOG ═══ #}
  <div class="divider">ADMIN LOG</div>

  <table class="admin-table">
    <thead>
      <tr>
        <th>Time</th>
        <th>User</th>
        <th>Action</th>
        <th>Detail</th>
      </tr>
    </thead>
    <tbody>
      {% for entry in log %}
      <tr>
        <td>{{ entry.created_at }}</td>
        <td>{{ entry.admin_user }}</td>
        <td>{{ entry.action }}</td>
        <td>{{ entry.detail }}</td>
      </tr>
      {% else %}
      <tr><td colspan="4" style="color:var(--text-ghost);font-style:italic;">No actions logged.</td></tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
