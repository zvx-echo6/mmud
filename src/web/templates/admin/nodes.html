{% extends "admin/base.html" %}

{% block title %}Node Assignment{% endblock %}

{% block admin_content %}
  <div class="page-header" style="padding-top:20px;">
    <h1 class="page-title" style="font-size:22px;">Sim Nodes</h1>
    <p class="page-subtitle">Assign Meshtastic node IDs to game roles.</p>
  </div>

  {# ═══ NODE TABLE ═══ #}
  <table class="admin-table">
    <thead>
      <tr>
        <th>Role</th>
        <th>Description</th>
        <th>Node ID</th>
        <th>Assigned</th>
      </tr>
    </thead>
    <tbody>
      {% for node in nodes %}
      <tr>
        <td style="color:var(--parchment);">{{ node.role }}</td>
        <td style="font-family:'Crimson Text',serif;font-size:13px;">{{ node.description or '' }}</td>
        <td>{{ node.mesh_node_id or '—' }}</td>
        <td>{{ node.assigned_at or '—' }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {# ═══ ASSIGN FORM ═══ #}
  <div class="divider">ASSIGN NODE</div>

  <form method="post" action="{{ url_for('admin.nodes_assign') }}" style="max-width:400px;">
    <label style="font-family:'Cinzel',serif;font-size:9px;letter-spacing:0.2em;color:var(--text-ghost);text-transform:uppercase;display:block;margin-bottom:6px;">Role</label>
    <select name="role" class="admin-input" style="appearance:auto;">
      {% for node in nodes %}
      <option value="{{ node.role }}">{{ node.role }}</option>
      {% endfor %}
    </select>

    <label style="font-family:'Cinzel',serif;font-size:9px;letter-spacing:0.2em;color:var(--text-ghost);text-transform:uppercase;display:block;margin-bottom:6px;">Meshtastic Node ID</label>
    <input type="text" name="mesh_node_id" class="admin-input" placeholder="!abcd1234" autocomplete="off">

    <button type="submit" class="admin-btn">Assign</button>
  </form>
{% endblock %}
