{% extends "admin/base.html" %}

{% block title %}Mesh Nodes{% endblock %}

{% block admin_content %}
  <div class="page-header" style="padding-top:20px;">
    <h1 class="page-title" style="font-size:22px;">Mesh Nodes</h1>
    <p class="page-subtitle">Live connection status for all mesh nodes. Click a row to configure.</p>
  </div>

  {# ═══ NODE TABLE ═══ #}
  <table class="admin-table">
    <thead>
      <tr>
        <th>Role</th>
        <th>Description</th>
        <th>Connection</th>
        <th>Node ID</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for node in nodes %}
      <tr style="cursor:pointer;" onclick="window.location='{{ url_for('admin.node_detail', role=node.role) }}'">
        <td style="color:var(--parchment);font-weight:bold;">{{ node.display_name or node.role|upper }}</td>
        <td style="font-family:'Crimson Text',serif;font-size:13px;">{{ node.description or '' }}</td>
        <td style="font-family:'JetBrains Mono',monospace;font-size:12px;">{{ node.connection or '—' }}</td>
        <td style="font-family:'JetBrains Mono',monospace;font-size:12px;">{{ node.mesh_node_id or '—' }}</td>
        <td>
          {% if node.connected %}
            <span style="color:var(--ember-glow);">connected</span>
          {% elif node.connection %}
            <span style="color:var(--blood-bright);">disconnected</span>
          {% else %}
            <span style="color:var(--text-ghost);">not configured</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% if nodes %}
  <p style="font-family:'Crimson Text',serif;font-size:12px;color:var(--text-ghost);margin-top:16px;">
    Connection strings are stored in the database. Environment variables are used as fallback on first boot only.
  </p>
  {% endif %}
{% endblock %}
